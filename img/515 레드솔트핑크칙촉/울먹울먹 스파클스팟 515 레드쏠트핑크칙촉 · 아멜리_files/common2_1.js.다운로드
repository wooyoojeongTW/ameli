/**
* 카페24쇼핑몰 선물하기 공통 
*
* @package gift
* @author webnmobile
* @version 2020-05-11
*/
var webnmobile = {};
webnmobile.gift = {
	apiUrl : "https://api.mintweb.kr/gift/api/", // Api URL 
	SHOP_NO : 1, // 쇼핑몰 번호 
	Mall_ID : "", // 상점 ID 
	config : {}, // 설정 
	checkOr : false,
	/**
	 * 주문서 내 선물하기 상품 조회
	 */
	getProduct : function() {
		var goodsList = [];
		$('.ec-product-name').each(function(){
		    goodsNo = $(this).attr("href").split("/");
		    if(goodsList.indexOf(goodsNo[3]) === -1){
		    	goodsList.push(goodsNo[3]);
		    }
		});
		$.ajax({
			url : this.apiUrl + "gift_check",
			type : "post",
			dataType : "json",
			data : { mall_id : this.Mall_ID, goodsList : goodsList },
			async : false,
			success : function (data) {
				if(data == true){
					returnData = 1;
				}else{
					returnData = 0;
				}
			},
			error : function (res) {
				returnData = 0;
			}
		});
		return returnData;
	},
	/**
	* 상점별 설정 조회 
	*
	* return Json
	*/
	getConfig : function() {
		$.ajax({
			url : this.apiUrl + "get_config",
			type : "post",
			dataType : "json",
			data : { mall_id : this.Mall_ID },
			async : false,
			success : function (data) {
				
				webnmobile.gift.config = data;
			},
			error : function (res) {
				webnmobile.gift.config = null;
				console.log(res);
			}
		});
		
		return webnmobile.gift.config;
	},
	
	/**
	* 초기화, 페이지 URL에 따라 선별적으로 초기화  
	* 
	* @param String Mall_ID 상점 ID 
	*/
	init : function(Mall_ID, SHOP_NO) {
		this.Mall_ID = Mall_ID;
		this.SHOP_NO = SHOP_NO;

		var loc = this.getLocation();
		/* 상점별 설정 조회 */
		var config = this.getConfig();
		console.log(config);

		if(config == null){
			this.deleteCookie("webnGiftProduct");
			this.deleteCookie("webnGiftOrder");
			return false;
		}

		if (config.useRange == 'none' && loc == 'orderform') {
			if(this.Mall_ID =='webnmobile1' || this.Mall_ID == 'lgbeauty01'){			
				this.loadHtml("notOrder", "#frm_order_act", "prepend", {giftProduct : 0});
			}
		}
		
		/* 적용 가능 조건 체크 */
		if (typeof config == "undefined" || typeof config.useRange == "undefined" || config.useRange == 'none' )
			return false;
		
		switch (loc) {
			/* 주문서폼 선물하기 HTML  */
			case "orderform" : 

				this.deleteCookie("webnGiftOrder");

				var webnGiftProduct = this.getCookie("webnGiftProduct");

				/* 국내 배송 주문서인지 체크하고 해외 배송인 경우 일반 주문 처리 */
				var delvtype = this.getParam("delvtype");
				if ((config.useRange == 'all' || webnGiftProduct) && delvtype == 'B') {
					if (confirm("선물하기는 국내배송지역에서만 가능합니다. 그래도 주문을 진행하시겠습니까?")) {
						this.deleteCookie("webnGiftProduct");
						this.deleteCookie("webnGiftOrder");
						webnGiftProduct = 0;
						config.useRange = "none";
					} else {
						window.history.back();
						return;
					}
				}

				if($('#is_subscription_invoice').val() == 'T' && (typeof webnGiftProduct != 'undefined' && webnGiftProduct == '1')){
					if(confirm("선물하기는 일반결제에서만 가능합니다. 그래도 주문을 진행하시겠습니까?")){
						this.deleteCookie("webnGiftProduct");
						this.deleteCookie("webnGiftOrder");
						webnGiftProduct = 0;
						config.useRange = "none";
					}else {
						window.history.back();
						return;
					}
				}

				if (config.useRange == 'all') { // 전체 상품 적용일 경우
					/* 기본 : 전체상품 + 개별상품 */
					if((this.Mall_ID == 'webnmobile1' || this.Mall_ID == 'kokacharm' || this.Mall_ID == 'damso8071'
						|| this.Mall_ID == 'lotteconf' || this.Mall_ID =='mfood1981' || this.Mall_ID =='soback2' || this.Mall_ID == 'looxloo24' || this.Mall_ID == 'jsm1218') && webnGiftProduct == 1){
						if (typeof webnGiftProduct != 'undefined' && webnGiftProduct == '1') {
							// 전용 상품일 경우 
							/**
							* 선물하기 전용 상품만 주문서에 있는지 여부 체크 하고 
							* 섞여 있는 경우는 주문이 되지 않도록 차단 
							*/
							try {
								
								//this.chkGiftProductOrder();

							} catch (e) {
								//alert(e);
								//window.history.back();
								webnGiftProduct = 0;
							}
							if (webnGiftProduct) {
								this.loadHtml("order", "#frm_order_act", "prepend", {giftProduct : 1});
							}
						}
					}else{
					var mode = "prepend";
					/* 베이직 스킨이 아닌 경우 */
					if ($("#mCafe24Order").length  == 0) {
						
						var html = "<tr>";
								html += '<th></th>';
								html += "<td id='mCafe24Order' class='isAddedHtml'></td>";
								html += "</tr>";
						if ($(".orderArea .ec-base-table tbody").length > 0) { // 스마트 디자인 베이직 스킨
							if(this.Mall_ID == 'apharmhealth'){
								var html2 = "<div id='mCafe24Order' class='isAddedHtml'></div>"; 
								$('#rname').closest(".orderArea").before(html2);
							}else{
								$(".orderArea .ec-base-table tbody").eq(0).prepend(html);
							}
							mode = "replace";
						} else if ($(".recipient table tbody").length > 0) {
							if(this.Mall_ID == 'drgroot'){
								var html2 = "<div id='mCafe24Order' class='isAddedHtml'></div>"; 
								$("#rname").closest('.recipient').eq(0).prepend(html2);
							}else{
								$(".recipient table tbody").eq(0).prepend(html);
							}
						} else{
							var html2 = "<div id='mCafe24Order' class='isAddedHtml'></div>"; 
							if(this.Mall_ID == 'apharmhealth'){
								$('#rname').closest(".orderArea").before(html2);
							}
							if(this.Mall_ID == 'jsm1218'){
								$('.order-wrap').prepend(html2);
							}
						}
					} 
					
					
					this.loadHtml("order", "#mCafe24Order", mode);
					}
				} else if (config.useRange == 'goods') {
					
					/* 테스트중
					if(this.Mall_ID =='webnmobile1'){
						if(this.getProduct()){
							var mode = "prepend";
							// 베이직 스킨이 아닌 경우 
							if ($("#mCafe24Order").length  == 0) {
								var html = "<tr>";
										html += '<th></th>';
										html += "<td id='mCafe24Order' class='isAddedHtml'></td>";
										html += "</tr>";
								if ($(".orderArea .ec-base-table tbody").length > 0) { // 스마트 디자인 베이직 스킨 
									$(".orderArea .ec-base-table tbody").eq(0).prepend(html);
									mode = "replace";
								} else if ($(".recipient table tbody").length > 0) {
									$(".recipient table tbody").eq(0).prepend(html);
								}
							} 
							
							
							this.loadHtml("order", "#mCafe24Order", mode);
						}
						
						*/
					//}else{
						
					
					
					
					/**
					* 장바구니를 통해서 주문하는 경우 선물하기 전용 상품인지를 구분하는 쿠키값이 유지
					* 되지 않으므로 전용 상품이 포함되어 있는지 체크한 후 쿠키값 다시 설정 
					*/
					/*
					if (typeof webnGiftProduct == 'undefined' || webnGiftProduct != '1') {
						var isGiftIncluded = false;
						CAFE24API.getCartItemList(function(err, res) {
							if (!err) {	
								if (res && res.items.length > 0) {
									var items = res.items;
									items.forEach(function(el) {
										var isPossible = false;
										var product_no = el.product_no;
										if (config.pList && config.pList.length > 0) {
											for (key in config.pList) {
												var c = config.pList[key];
												if (c.product_no == product_no && c.isGift == '1') {
													isGiftIncluded = true;
													break;
												}
											}
										} // endif 
									});
								} 
							}
						});
						
						/* 선물하기 상품이 포함되어 있는 경우  */
						/*
						if (isGiftIncluded) {
							this.setCookie("webnGiftProduct", 1);
							var webnGiftProduct = 1;
						}
				
						
					} // endif 
					*/
					if (typeof webnGiftProduct != 'undefined' && webnGiftProduct == '1') {//상품상세에서 선물하기버튼 클릭시 주문서에서 호출
						// 최근 배송지가 지역별 배송지 요금이 부과되는경우를 대비
						$('#sameaddr1').click();
					
						
						
						// 전용 상품일 경우 
						/**
						* 선물하기 전용 상품만 주문서에 있는지 여부 체크 하고 
						* 섞여 있는 경우는 주문이 되지 않도록 차단 
						*/
						try {
							this.chkGiftProductOrder();
							webnGiftProduct = this.chkGiftProductOrder2();
						} catch (e) {
							//alert(e);
							//window.history.back();
							webnGiftProduct = 0;
						}
						if (webnGiftProduct) {
							//선물하기 주문후 일반주문시 선물하기로 인식방지
							if(this.Mall_ID == 'thearomatica2'){
								console.log('test');
								$('#ec-jigsaw-tab-shippingInfo-newAddress').trigger('click');
							}
							this.loadHtml("order", "#frm_order_act", "prepend", {giftProduct : 1});
						}
					}else{
						//선물하기 주문후 일반주문시 선물하기로 인식방지
						if(this.Mall_ID =='webnmobile1' || this.Mall_ID == 'lgbeauty01'){
							
							this.loadHtml("notOrder", "#frm_order_act", "prepend", {giftProduct : 0});
						}
						
					}
					
					//}
				}
				break;
			/* 주문서 폼 완료 처리 */
			case "orderDone": 
				/* 주문완료시에는 전체, 상품 개별 상관없이 선물하기 App으로 데이터를 전송 */
				var order_id = this.getParam("order_id");
				if (typeof order_id == "undefined" || order_id == "")
					return;
				var gMallId=webnmobile.gift.Mall_ID;
				
				var send_check = false;
				/* 선물하기 주문인지 다시 확인 */
//				if(webnmobile.gift.Mall_ID == 'webnmobile1'){
					$list = $("*");
				    if ($list.length > 0) {
				        $.each($list, function() {
				            var text =  $(this).text();
				            if(!send_check){
				            	if (text == '선물받는분이 배송지정보를 수정하실 수 있습니다. 선물받는분이 배송지정보를 수정하실 수 있습니다.' || text == '선물 받는 분이 배송지정보를 입력합니다. 선물 받는 분이 배송지정보를 입력합니다.' || text == '선물 받는 분이 배송지 정보를 수정하실 수 있습니다. 선물 받는 분이 배송지 정보를 수정하실 수 있습니다.' || text == '결제하는 즉시 선물 받는 분에게 직접 주소를 입력할 수 있는 링크가 발송됩니다. 결제하는 즉시 선물 받는 분에게 직접 주소를 입력할 수 있는 링크가 발송됩니다.' || text == '수령자분이 주소지 수정 가능합니다. 수령자분이 주소지 수정 가능합니다.' || text == '받는 분이 배송지 정보를 입력하실 수 있습니다.' || text == '결제하는 즉시 선물 받는 분이 배송지 정보를 입력할 수 있습니다.' || text == "결제하는 즉시 모든 배송지 정보는 선물 받는 분의 요청사항에 따라 배송됩니다. 아래 '추가입력' 사항은 모두 '임의로' 선택 하시면 됩니다."
									|| text == '선물하기는 주소를 입력하지 않으셔도 됩니다.') {
//					            	console.log('send_check');
					            	webnmobile.gift.sendOrderInfo(order_id);
					            	send_check = true;
					            }else if (text.indexOf('받는 분이 배송지 정보를 입력하실 수 있습니다.') > -1) { // text에 일치하지 않아도 해당 문구가 포함되어 있는 경우 메시지가 발송 되도록 수정
					            	webnmobile.gift.sendOrderInfo(order_id);
					            	send_check = true;
					            }
				            }
				       });
				   }
//				}else{
//					this.sendOrderInfo(order_id);
//				}
				

				if(!webnmobile.gift.checkOr)
					break;
				if(webnmobile.gift.Mall_ID == 'goldenmilk1'){
					$('h2:contains("배송지")').html('선물 받는 분 정보');
					$('h3:contains("배송지정보")').html('선물 받는 분 정보');
					$('th:contains("우편번호")').closest("tr").remove();
					$('th:contains("받는사람")').html('선물 받는 분');
					$('th:contains("받으시는분")').html('선물 받는 분');
					$('th:contains("연락처")').html('선물 받는 분 연락처');
					$('th:contains("일반전화")').closest("tr").remove();
					$('th:contains("휴대전화")').html('선물 받는 분 연락처');
					$('th:contains("배송요청")').html('선물 메시지');
					$('th:contains("배송메시지")').html('선물 메시지');
				}else{
					/* 2020-09-25 주문 완료 이름 변경*/
					$('h2:contains("배송지")').html('선물 받는 사람 정보');
					$('h3:contains("배송지정보")').html('선물 받는 사람 정보');
					$('th:contains("우편번호")').closest("tr").remove();
					$('th:contains("받는사람")').html('선물 받는 사람');
					$('th:contains("받으시는분")').html('선물 받는 사람');
					$('th:contains("연락처")').html('선물 받는 사람 연락처');
					$('th:contains("일반전화")').closest("tr").remove();
					$('th:contains("휴대전화")').html('선물 받는 사람 연락처');
					$('th:contains("배송요청")').html('선물 메시지');
					$('th:contains("배송메시지")').html('선물 메시지');
				}
				
				$list = $("*");
				if ($list.length > 0) {
					$.each($list, function() {
						var text =  $(this).text();
						if (text == '선물받는분이 배송지정보를 수정하실 수 있습니다. 선물받는분이 배송지정보를 수정하실 수 있습니다.' || text == '선물 받는 분이 배송지정보를 입력합니다. 선물 받는 분이 배송지정보를 입력합니다.' || text == '선물 받는 분이 배송지 정보를 수정하실 수 있습니다. 선물 받는 분이 배송지 정보를 수정하실 수 있습니다.' || text == '결제하는 즉시 선물 받는 분에게 직접 주소를 입력할 수 있는 링크가 발송됩니다. 결제하는 즉시 선물 받는 분에게 직접 주소를 입력할 수 있는 링크가 발송됩니다.' || text == '수령자분이 주소지 수정 가능합니다. 수령자분이 주소지 수정 가능합니다.' || text == '받는 분이 배송지 정보를 입력하실 수 있습니다.' || text == '결제하는 즉시 선물 받는 분이 배송지 정보를 입력할 수 있습니다.' || text == "결제하는 즉시 모든 배송지 정보는 선물 받는 분의 요청사항에 따라 배송됩니다. 아래 '추가입력' 사항은 모두 '임의로' 선택 하시면 됩니다."
							|| text == '선물하기는 주소를 입력하지 않으셔도 됩니다.') {
							
							var html = "<div class='guide_box' style='border: 1px solid blue; padding: 10px; font-weight: bold; background-color: #f8f8f8;'>";
							html += "<div>입금이 확인이 되면 자동으로 카카오 알림톡 또는 SMS가 선물받으시는 분에게 전송이 됩니다.</div>";
							html += "<div>카카오 알림톡의 선물받기 버튼이나 SMS에 전송되는 URL을 클릭하면 선물받으시는 분이 받으시는 선물과 선물 메세지를 확인 하실 수 있으며 배송지정보를 수정하실 수 있습니다.</div>";
							html += "</div>";

							if(gMallId == 'youngmill' || gMallId == 'woozooinpizza'){
								var html = "<div class='guide_box' style='border: 1px solid blue; padding: 10px; font-weight: bold; background-color: #f8f8f8;'>";
								html += "<div>\"선물 받는 사람\"이 배송지 정보를 직접 입력합니다.</div>";
								html += "<div>받는 사람에게 자동 전송된 SMS문자를 통해 선물과 메시지를 확인하고, 배송 받으실 주소를 입력 할 수있습니다.</div>";
								html += "</div>";
							}
							
							if(webnmobile.gift.Mall_ID == 'goldenmilk1'){
								var html = "<div class='guide_box' style='border: 1px solid blue; padding: 10px; font-weight: bold; background-color: #f8f8f8;'>";
								html += "<div>결제가 완료되면 선물 받는 분의</div>";
								html += "<div>핸드폰번호로 문자가 전송됩니다.</div>";
								html += "<div>전송된 문자의 URL을 클릭하면</div>";
								html += "<div>선물과 선물 메시지를 확인하실 수 있으며,</div>";
								html += "<div>배송정보를 입력하실 수 있습니다.</div>";
								html += "</div>";
							}
							
							if(webnmobile.gift.Mall_ID == 'glyde'){
								var html = "<div class='guide_box' style='border: 1px solid blue; padding: 10px; font-weight: bold; background-color: #f8f8f8;'>";
								html += "<div>입금이 확인이 되면 자동으로 카카오 알림톡 또는 SMS가 선물 받으시는 분에게 전송이 됩니다.</div>";
								html += "<div>카카오 알림톡의 선물 받기 버튼이나 SMS에 전송되는 URL을 클릭하면 선물받으시는 분이 받으시는 선물과 선물 메시지를 확인하실 수 있으며 배송지 정보를 수정하실 수 있습니다. 선물 전송 후 7일 이내 배송지 정보를 입력하지 않으실 경우 주문이 취소되어 선물하신 분에게 환불됩니다.</div>";
								html += "</div>";
							}
							
							$(this).html(html);
						} else if (text == '00000') {
							$(this).remove();
						}
					});
				} // endif 
				
				
				if(gMallId=='youngmill' || gMallId == 'woozooinpizza'){
					$('.orderInfo p strong').html('고객님의 선물하기 주문이 완료 되었습니다.');
					$('.resultArea p strong').html('고객님의 선물하기 주문이 완료 되었습니다.');
				}
				
				break;
			/* 주문상세조회 */
			case "orderDetail" : 
				this.deleteCookie("webnGiftProduct");
				this.deleteCookie("webnGiftOrder");
				
				/* 선물하기 주문인 경우는 배송지변경 버튼 제거 */
				var order_id = this.getParam('order_id');
				var chk = this.chkGiftOrder(order_id);
				
				if(!webnmobile.gift.checkOr)
					break;
				
				if(webnmobile.gift.Mall_ID == 'goldenmilk1'){
					$('h2:contains("배송지")').html('선물 받는 분 정보');
					$('h3:contains("배송지정보")').html('선물 받는 분 정보');
					$('th:contains("받으시는분")').html('선물 받는 분');
					$('th:contains("우편번호")').closest("tr").remove();
					$('th:contains("일반전화")').closest("tr").remove();
					$('th:contains("휴대전화")').html('선물 받는 분 연락처');
					$('th:contains("배송메시지")').html('선물 메시지');
				}else{
					/* 2020-09-25 주문 상세 이름 변경*/
					$('h2:contains("배송지")').html('선물 받는 사람 정보');
					$('h3:contains("배송지정보")').html('선물 받는 사람 정보');
					$('th:contains("받으시는분")').html('선물 받는 사람');
					$('th:contains("우편번호")').closest("tr").remove();
					$('th:contains("일반전화")').closest("tr").remove();
					$('th:contains("휴대전화")').html('선물 받는 사람 연락처');
					$('th:contains("배송메시지")').html('선물 메시지');
				}
				
				

				$list = $("*");
				if ($list.length > 0) {
					$.each($list, function() {
						var text =  $(this).text();
						if (text == '선물받는분이 배송지정보를 수정하실 수 있습니다. 선물받는분이 배송지정보를 수정하실 수 있습니다.' || text == '선물 받는 분이 배송지정보를 입력합니다. 선물 받는 분이 배송지정보를 입력합니다.' || text == '선물 받는 분이 배송지 정보를 수정하실 수 있습니다. 선물 받는 분이 배송지 정보를 수정하실 수 있습니다.' || text == '결제하는 즉시 선물 받는 분에게 직접 주소를 입력할 수 있는 링크가 발송됩니다. 결제하는 즉시 선물 받는 분에게 직접 주소를 입력할 수 있는 링크가 발송됩니다.' || text == '수령자분이 주소지 수정 가능합니다. 수령자분이 주소지 수정 가능합니다.' || text == '받는 분이 배송지 정보를 입력하실 수 있습니다.' || text == '결제하는 즉시 선물 받는 분이 배송지 정보를 입력할 수 있습니다.' || text == "결제하는 즉시 모든 배송지 정보는 선물 받는 분의 요청사항에 따라 배송됩니다. 아래 '추가입력' 사항은 모두 '임의로' 선택 하시면 됩니다."
							|| text == '선물하기는 주소를 입력하지 않으셔도 됩니다.') {
							var html = "<div class='guide_box' style='border: 1px solid blue; padding: 10px; font-weight: bold; background-color: #f8f8f8;'>";
							html += "<div>입금이 확인이 되면 자동으로 카카오 알림톡 또는 SMS가 선물받으시는 분에게 전송이 됩니다.</div>";
							html += "<div>카카오 알림톡의 선물받기 버튼이나 SMS에 전송되는 URL을 클릭하면 선물받으시는 분이 받으시는 선물과 선물 메세지를 확인 하실 수 있으며 배송지정보를 수정하실 수 있습니다.</div>";
							html += "</div>";
							
							if(webnmobile.gift.Mall_ID == 'goldenmilk1'){
								var html = "<div class='guide_box' style='border: 1px solid blue; padding: 10px; font-weight: bold; background-color: #f8f8f8;'>";
								html += "<div>결제가 완료되면 선물 받는 분의</div>";
								html += "<div>핸드폰번호로 문자가 전송됩니다.</div>";
								html += "<div>전송된 문자의 URL을 클릭하면</div>";
								html += "<div>선물과 선물 메시지를 확인하실 수 있으며,</div>";
								html += "<div>배송정보를 입력하실 수 있습니다.</div>";
								html += "</div>";
							}
							
							if(webnmobile.gift.Mall_ID == 'glyde'){
								var html = "<div class='guide_box' style='border: 1px solid blue; padding: 10px; font-weight: bold; background-color: #f8f8f8;'>";
								html += "<div>입금이 확인이 되면 자동으로 카카오 알림톡 또는 SMS가 선물 받으시는 분에게 전송이 됩니다.</div>";
								html += "<div>카카오 알림톡의 선물 받기 버튼이나 SMS에 전송되는 URL을 클릭하면 선물받으시는 분이 받으시는 선물과 선물 메시지를 확인하실 수 있으며 배송지 정보를 수정하실 수 있습니다. 선물 전송 후 7일 이내 배송지 정보를 입력하지 않으실 경우 주문이 취소되어 선물하신 분에게 환불됩니다.</div>";
								html += "</div>";
							}
							
							$(this).html(html);
						} else if (text == '00000') {
							$(this).remove();
						}
					});
				} // endif 
				
				break;
			/* 상품 상세 처리 */
			case "product" : 
				
				this.deleteCookie("webnGiftProduct");
				
				/* lotteconf 쇼핑몰 예외 처리 추가 */
				if(this.Mall_ID == 'lotteconf' && config.useRange == 'all'){
					$('.present_text2').addClass('present_show_text');
				}
				

				/* 적용 가능 조건 체크 */
				if (config.useRange != 'goods'){
					if(config.useRange == 'all' && (this.Mall_ID == 'apharmhealth' || this.Mall_ID == 'webnmobile1' || this.Mall_ID == 'kokacharm'
						|| this.Mall_ID == 'damso8071' || this.Mall_ID == 'mfood1981' || this.Mall_ID =='soback2' || this.Mall_ID == 'looxloo24' || this.Mall_ID == 'jsm1218')){
					}else{
						return false;
					}
					
				}

				if(this.Mall_ID == 'lotteconf' && config.useRange == 'goods'){
//					$('.present_box').addClass('webnmobile_product_html');
//					$('.icon_present').addClass('gift_order_btn');
				}
				
				var paths = location.pathname.split("/");
				
				var product_no = parseInt(paths[3]);
				if (isNaN(product_no)) product_no = 0;
				
				if (product_no == 0) {
					product_no = parseInt(this.getParam('product_no'));
					if (isNaN(product_no)) product_no = 0
				}
				
				//품절 체크
				var soldOutFl = this.checkSoldOut(product_no);
				
				if(soldOutFl == 'T'){
					return false;
				}
				
				var isPossible = false;
				
				if (config.pList && config.pList.length > 0) {
					for (key in config.pList) {
						var c = config.pList[key];
						if (c.product_no == product_no && c.isGift == '1') {
							isPossible = true;
							break;
						}
					}
				} // endif 
				if(config.useRange == 'all' && (this.Mall_ID == 'apharmhealth' || this.Mall_ID == 'damso8071' || this.Mall_ID == 'mfood1981' || this.Mall_ID == 'soback2' || this.Mall_ID == 'looxloo24' || this.Mall_ID == 'jsm1218')){
					isPossible = true;
				}
				console.log(isPossible);
				if (!isPossible)
					return false;
				
				/* 선물하기 전용 상품인 경우 표기 */

				this.setCookie("webnGiftProduct", 1);

				if(this.Mall_ID =='thearomatica2' || this.Mall_ID == 'aout0629658' || this.Mall_ID == 'uuimui'){
					this.deleteCookie("webnGiftProduct");
				}
				/* 선물하기 전용 버튼 출력 */
				//PC 모바일 확인
				var con = window.location.hostname.substring(0,2);
				
				if(this.Mall_ID=='ghkizco'){
					this.loadHtml("product", ".xans-product-action", "append");
				}else if(this.Mall_ID=='rudiabb'){
					this.loadHtml("product", ".xans-product-action", "append");
				}else if(this.Mall_ID=='innoceanbizx'){
					this.loadHtml("product", ".xans-product-action", "append");
				}else if(this.Mall_ID=='ozkiz1'){
					this.loadHtml("product", ".xans-product-action", "append");
					this.loadHtml("product", ".first .btnArea, .second", "append");
				}else if(this.Mall_ID=='ns811'){
					this.loadHtml("product", ".infoArea .xans-product-action", "prepend");
					this.loadHtml("product", "#fixedActionButton", "prepend");
				}else if(this.Mall_ID=='serineyu2020'){
					this.loadHtml("product", ".gColumn", "append");
					this.loadHtml("product", "#fixedActionButton, .prdDesc_fixed_menu_text", "prepend");
				}else if(this.Mall_ID=='dewit'){
					this.loadHtml("product", ".infoArea .gColumn", "prepend");
					this.loadHtml("product", "#fixedActionButton .gColumn, #orderFixArea .gColumn, #product_detail_option_layer .gColumn","prepend");
				}else if(this.Mall_ID=='mamaforest'){
					this.loadHtml("product", "#infoArea .xans-product-action", "append");
					this.loadHtml("product", "#fixedActionButton .gColumn", "prepend");
				}else if(this.Mall_ID=='asyou1'){
					this.loadHtml("product", ".infoArea .ec-base-button","append");
					this.loadHtml("product", "#fixedActionButton .dj-btn-detail","append");
				}else if(this.Mall_ID=='youngmill'){
					if( con == 'm.') {
						this.loadHtml("product", "#fixedActionButton", "replace");
					}else{
						this.loadHtml("product", ".xans-product-action", "prepend");
					}
				}else if(this.Mall_ID=='purplus'){
					if( con == 'm.') {
						this.loadHtml("product", ".xans-product-action", "append");
					}else{
						this.loadHtml("product", ".xans-product-action .ec-base-button", "append");
					}
				}else if(this.Mall_ID=='lotteconf'){
					if( con == 'm.') {
						this.loadHtml("product", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product", ".xans-product-action", "prepend");
					}
				}else if(this.Mall_ID=='lumiiworld1'){
					if( con == 'm.') {
						this.loadHtml("product", "#fixedActionButton .typeWide", "append");
						this.loadHtml("product", "#product_detail_option_layer .xans-product-action .type3", "prepend");
					}else{
						this.loadHtml("product", ".xans-product-action .ec-base-button", "append");
					}
				}else if(this.Mall_ID=='hinok1'){
					this.loadHtml("product",".xans-product-action", "append");
				}else if(this.Mall_ID=='apharmhealth'){
					if( con == 'm.') {
						this.loadHtml("product","#fixedActionButton .btn_buy ","prepend");
					}else{
						this.loadHtml("product",".xans-product-action .gColumn", "prepend");
					}
				}else if(this.Mall_ID=='dduckhamji12'){
					this.loadHtml("product",".xans-product-action","prepend");
				}else if(this.Mall_ID=='millionbeauty'){
//					if( con == 'm.') {
//						this.loadHtml("product",".wp-buy-step2 .xans-layout","prepend");
//					}else{
//						this.loadHtml("product",".xans-product-action","prepend");
//					}
//					if(location.hash == '#test'){
						this.loadHtml("product_millionbeauty",".infoArea .xans-product-action .ec-base-button","append");
//					}else{
//						this.deleteCookie("webnGiftProduct");
//					}
					
				}else if(this.Mall_ID == 'hdbphysiogel'){
					if( con == 'm.') {
						this.loadHtml("product", "#fixedActionButton .dj-btn-detail", "prepend");
					}else{
						this.loadHtml("product", ".xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'lgbeauty01'){
					if( con == 'm.') {
						this.loadHtml("product_lgbeauty01", ".wp-buy-step2 > ul", "append");
					}else{
						this.loadHtml("product_lgbeauty01", "#optionG .xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'yarnnakarn'){
					if( con == 'm.') {
						this.loadHtml("product", "#fixedActionButton ", "append");
					}else{
						this.loadHtml("product", ".infoArea .xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'kokacharm'){
					if( con == 'm.') {
						this.loadHtml("product", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product", ".xans-product-action", "prepend");
					}
				}else if(this.Mall_ID == 'oneroommake'){
					if( con == 'm.') {
						this.loadHtml("product", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product", "#sp-payment-price .xans-product-action .sp-btn-group", "append");
					}
				}else if(this.Mall_ID == 'goldenmilk1'){
					if( con == 'm.') {
						this.loadHtml("product", ".xans-product-action", "append");
					}else{
						this.loadHtml("product", ".xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'skinnypig2018'){
					if( con == 'm.') {
						this.loadHtml("product", ".xans-product-action", "append");
					}else{
						this.loadHtml("product", ".xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'rhcrpdi1'){
					if( con == 'm.') {
						this.loadHtml("product", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product", ".xans-product-action", "prepend");
					}
				}else if(this.Mall_ID == 'vcservice'){
					if( con == 'm.') {
						this.loadHtml("product", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product", ".xans-product-action", "prepend");
					}
				}else if(this.Mall_ID == 'wineplz'){
					if( con == 'm.') {
						this.loadHtml("product", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product", "#infoArea_fixed .xans-product-action .button_box", "prepend");
					}
				}else if(this.Mall_ID == 'thearomatica2'){
					// if(location.host == 'skin-skin47.thearomatica2.cafe24.com') {
							this.loadHtml("product_thearomatica277", ".xans-product-action .ec-base-button ", "append"); //w주석
					// 		// this.deleteCookie("webnGiftProduct");
					// }else {
					// 	if (con == 'm.') {
					// 		this.loadHtml("product_thearomatica2", ".xans-product-action .ec-base-button > div", "append");
					// 	} else {
					// 		this.loadHtml("product_thearomatica2", ".xans-product-action .ec-base-button > div", "append");
					// 	}
					// }

					// $(".xans-product-image .xans-product-action").remove();
				}else if(this.Mall_ID == 'beyondmall'){
					if( con == 'm.') {
						this.loadHtml("product", "#fixedActionButton", "prepend");
					}else{
						this.loadHtml("product", ".xans-product-action .df-action-button", "append");
					}
				}else if(this.Mall_ID == 'misomeat'){
					if( con == 'm.') {
						this.loadHtml("product", ".xans-product-action", "append");
					}else{
						this.loadHtml("product", ".xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'damso8071'){
					if( con == 'm.') {
						this.loadHtml("product_damso8071", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product_damso8071", ".xans-product-action", "prepend");
					}
				}else if(this.Mall_ID == 'teatreat'){
					if( con == 'm.') {
						this.loadHtml("product_teatreat", ".xans-product-action .ec-base-button", "prepend");
					}else{
						this.loadHtml("product_teatreat", ".xans-product-action .ec-base-button", "append");
					}
				}else if(this.Mall_ID == 'msglobal2019'){
					if( con == 'm.' ){
						this.loadHtml("product_msglobal2019", "#fixedActionButton", "append");
						this.loadHtml("product_msglobal2019", "#product_detail_option_layer", "append");
					}else{
						this.loadHtml("product_msglobal2019", ".infoArea .xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'kittybunnypony'){
					
					if( con == 'm.' ){
//						this.loadHtml("only_product_js", ".xans-product-action", "append");
						this.loadHtml("product_kittybunnypony", "#fixedActionButton .btnArea", "append");
						this.loadHtml("product_kittybunnypony_optionLayer", "#product_detail_option_layer .xans-product-action .btnArea", "append");
					}else{
						this.loadHtml("product_kittybunnypony", ".xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'reprodlife1234'){
					
					if( con == 'm.' ){
						this.loadHtml("product_reprodlife1234", "#fixedActionButton", "append");
						this.loadHtml("product_reprodlife1234_optionLayer", "#product_detail_option_layer .xans-product-action .ec-base-button ", "append");
					}else{
						this.loadHtml("product_reprodlife1234", ".xans-product-action .ec-base-button", "append");
					}
					this.loadHtml("only_product_js", ".xans-product-action", "append");
				}else if(this.Mall_ID == 'crassiangshop'){
					if( con == 'm.') {
						this.loadHtml("product_crassiangshop", ".xans-product-action .ec-base-button", "append");
					}else{
						this.loadHtml("product_crassiangshop", ".xans-product-action .ec-base-button", "append");
					}
				}else if(this.Mall_ID == 'barrelslee'){
					if( con == 'm.') {
						this.loadHtml("product_barrelslee", ".xans-product-action", "append");
					}else{
						this.loadHtml("product_barrelslee", ".productAction", "append");
						
					}
				}else if(this.Mall_ID == 'mandoo01966'){
					if( con == 'm.') {
						this.loadHtml("product_mandoo01966", ".xans-product-action .ec-base-button", "append");
					}else{
						this.loadHtml("product_mandoo01966", ".infoArea .xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'inbetween21'){
					if( con == 'm.') {
						this.loadHtml("product_inbetween21", ".xans-product-action", "append");
					}else{
						this.loadHtml("product_inbetween21", ".infoArea .xans-product-action .bk-btn-order", "append");
					}
				}else if(this.Mall_ID == 'ygnext'){
					this.loadHtml("product_ygnext", ".product_gift_btn", "replace");
					$(".xans-product-image .product_gift_btn").remove();
				}else if(this.Mall_ID == 'voar'){
					
//					if( con == 'm.') {
//						this.loadHtml("product_voar", ".xans-product-action .ec-base-button", "prepend");
//					}else{
//						if(location.search.indexOf("mintweb=test") != -1){
					if($('#btnBuy').closest('#option-layer').length){ // 옵션레이어가 존재하는 경우에는 html 다르게 추가
						this.loadHtml("product_voar_optionLayer", ".xans-product-action", "append");
//						this.deleteCookie("webnGiftProduct");
					} else { // 상푸 상세페이지
						this.loadHtml("product_voar", ".xans-product-action .gActionButtonColumn", "prepend");
					}
							
//						}else{
//							this.loadHtml("product_voar", ".infoArea .xans-product-action .ec-base-button", "prepend");
//							this.deleteCookie("webnGiftProduct");
//						}
						
//					}
				}else if(this.Mall_ID == 'eponakorea'){
					if( con == 'm.') {
						this.loadHtml("product_eponakorea", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product_eponakorea", ".infoArea .xans-product-action .ec-base-button", "append");
					}
				}else if(this.Mall_ID == 'stickher'){
					if( con == 'm.') {
						this.loadHtml("product_stickher", ".xans-product-action", "append");
					}else{
						this.loadHtml("product_stickher", ".xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'concre3'){
					if( con == 'm.') {
						this.loadHtml("product_concre3", ".xans-product-action", "append");
					}else{
						this.loadHtml("product_concre3", ".xans-product-action .ec-base-button", "append");
					}
				}else if(this.Mall_ID == 'gangnammarket'){
					this.loadHtml("product_gangnammarket", ".xans-product-action > ul", "append");
				}else if(this.Mall_ID == 'jachoco01'){
					if( con == 'm.') {
						this.loadHtml("product_jachoco01", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product_jachoco01", ".xans-product-action .ec-base-button", "append");
					}
				}else if(this.Mall_ID == 'bymstore'){
					if( con == 'm.') {
						this.loadHtml("product_bymstore", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product_bymstore", ".infoArea .xans-product-action", "prepend");
					}
				}else if(this.Mall_ID == 'haksanshopping'){
					/* 기존 css 유지하면서 네이버페이버튼 노출 */
					if( con == 'm.') {
						/* 옵션레이어의 버튼 숨기기 */
						$('.wm_product_option_displaynone').hide();
						this.loadHtml("product", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product", ".infoArea .xans-product-action", "prepend");
						if($('.xans-product-optionselectlayer').length){ // 옵션레이어의 경우
							/* 옵션레이어의 버튼 숨기기 */
							$('.wm_product_option_displaynone').hide();
							this.loadHtml("product", ".xans-product-optionselectlayer .xans-product-action", "prepend");
						}
						
					}
					$('.xans-product-action .ec-base-button').remove();
				}else if(this.Mall_ID == 'abalonekr1577'){
					if( con == 'm.') {
						this.loadHtml("product_abalonekr1577", ".xans-product-action", "prepend");
					}else{
						this.loadHtml("product_abalonekr1577", ".infoArea .xans-product-action", "prepend");
					}
				}else if(this.Mall_ID == 'wingbling'){
//					if(location.hash == '#test'){
						if( con == 'm.') {
							this.loadHtml("product_wingbling", ".btn_col2", "append");
						}else{
							this.deleteCookie("webnGiftProduct");
//							this.loadHtml("product_abalonekr1577", ".infoArea .xans-product-action", "prepend");
						}
//					}else{
//						this.deleteCookie("webnGiftProduct");
//						this.loadHtml("product", ".xans-product-action", "replace");
//						$(".xans-product-image .xans-product-action").remove();
//					}
					
				}else if(this.Mall_ID == 'wine10000'){
					if( con == 'm.') {
						this.loadHtml("product_wine10000", ".xans-product-action .ec-base-button", "append");
					}else{
						this.loadHtml("product_wine10000", ".xans-product-action .ec-base-button", "prepend");
					}
				}else if(this.Mall_ID == 'recsofficial'){
					if( con == 'm.') {
						this.loadHtml("product_recsofficial", ".xans-product-action .ec-base-button", "append");
					}else{
						this.loadHtml("product_recsofficial", ".xans-product-action .btnArea", "append");
					}
				}else if(this.Mall_ID == 'wnderk'){
					if( con == 'm.') {
						this.loadHtml("product_wnderk", ".xans-product-action", "append");
					}else{
						this.loadHtml("product_wnderk", ".xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'seoulbund2016'){
					if( con == 'm.') {
						this.loadHtml("product_seoulbund2016", "#fixedActionButton", "append");
					}else{
						this.loadHtml("product_seoulbund2016", ".infoArea .xans-product-action", "append");
					}
				}else if(this.Mall_ID == 'nnlab'){
					if( con == 'm.') {
						this.loadHtml("product_nnlab", ".xans-product-action .ec-base-button", "prepend");
					}else{
						this.loadHtml("product_nnlab", ".xans-product-action .ec-base-button", "prepend");
					}
				}else if(this.Mall_ID == 'whd0303'){
					if( con == 'm.') {
						this.loadHtml("product_whd0303", ".xans-product-action .btnArea", "append");
					}else{
						this.loadHtml("product_whd0303", ".xans-product-action .ec-base-button", "prepend");
					}
				}else if(this.Mall_ID == 'imalivekombucha'){
//					if(location.search.indexOf("mintweb=test") != -1){
						if( con == 'm.') {
							this.loadHtml("product_imalivekombucha", ".xans-product-action", "prepend");
//							this.loadHtml("product_imalivekombucha", ".xans-product-action .btnArea", "append");
						}else{
							this.loadHtml("product_imalivekombucha", ".xans-product-action", "prepend");
						}
//					}else{
//						this.deleteCookie("webnGiftProduct");
//					}
				}else if(this.Mall_ID == 'movementlab'){
//					if(location.search.indexOf("mintweb=test") != -1){
						if( con == 'm.') {
							this.loadHtml("product_movementlab", ".xans-product-action .ec-base-button", "replace");
						}else{
							this.loadHtml("product_movementlab", ".infoArea .xans-product-action .ec-base-button", "replace");
						}
//					}else{
//						this.deleteCookie("webnGiftProduct");
//					}
				}else if(this.Mall_ID == 'mdaida'){
//					if(location.search.indexOf("mintweb=test") != -1){
						if( con == 'm.') {
							this.loadHtml("product_mdaida", ".xans-product-action", "prepend");
						}else{
							this.loadHtml("product_mdaida", ".infoArea .xans-product-action", "prepend");
						}
//					}else{
//						this.deleteCookie("webnGiftProduct");
//					}
				}else if(this.Mall_ID == 'ysy5022'){
//					if(location.search.indexOf("mintweb=test") != -1){
						if( con == 'm.') {
//							this.loadHtml("product_you8503", ".xans-product-action", "prepend");
							this.loadHtml("product_ysy5022", ".wm_gift_area", "prepend");
						}else{
							this.loadHtml("product_ysy5022", ".wm_gift_area", "prepend");
						}
//					}else{
//						this.deleteCookie("webnGiftProduct");

				}else if(this.Mall_ID == 'bathmetics') {
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_bathmetics", ".xans-product-action .ec-base-button", "append");
					} else {
						this.loadHtml("product_bathmetics", ".xans-product-action .buyButton", "append");
					}
					// }else{
					// 	this.deleteCookie("webnGiftProduct");
					// }

				}else if(this.Mall_ID == 'duhooo') {
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_duhooo", ".xans-product-action .buyButton  ", "prepend");
					} else {
						this.loadHtml("product_duhooo", ".xans-product-action ", "prepend");
					}
					// }else{
					// 	this.deleteCookie("webnGiftProduct");
					// }

				}else if(this.Mall_ID == 'newdgz2018'){
					// if(location.search.indexOf("mintweb=test") != -1){
						if (con == 'm.') {
							console.log('test');
							this.loadHtml("product_newdgz2018_3", ".xans-product-action", "append");
						} else {
							this.loadHtml("product_newdgz2018_3", ".xans-product-action .ec-base-button", "prepend");
						}
					// }else{
					// 	if (con == 'm.') {
					//
					// 		this.loadHtml("product_newdgz2018_2", ".xans-product-action", "append");
					// 	} else {
					// 		this.loadHtml("product_newdgz2018_2", ".xans-product-action .ec-base-button", "prepend");
					// 	}
					// }

				}else if(this.Mall_ID == 'moomooz'){
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product", ".xans-product-action .ec-base-button", "replace");
					} else {
						this.loadHtml("product", ".xans-product-action .ec-base-button", "replace");
					}
					// }else{
					// 	this.loadHtml("product", ".xans-product-action", "replace");
					// 	$(".xans-product-image .xans-product-action").remove();
					// }

				}else if(this.Mall_ID == 'donad'){
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_donad", ".xans-product-action", "append");
					} else {
						this.loadHtml("product_donad", ".xans-product-action .sp__detail_buttons", "append");
					}
					// }else{
					// 	this.loadHtml("product", ".xans-product-action", "replace");
					// 	$(".xans-product-image .xans-product-action").remove();
					// }


				}else if(this.Mall_ID == 'harvestpick'){
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_harvestpick", ".xans-product-action ", "append");
					} else {
						this.loadHtml("product_harvestpick", ".xans-product-action .ec-base-button ", "append");
					}
					// }else{
					// 	this.loadHtml("product", ".xans-product-action", "replace");
					// 	$(".xans-product-image .xans-product-action").remove();
					//
					// }
				}else if(this.Mall_ID == 'soback2'){
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_soback2", ".xans-product-action ", "append");
					} else {
						this.loadHtml("product_soback2", ".xans-product-action .ec-base-button ", "append");
					}
					// }else{
					// 	// this.loadHtml("product", ".xans-product-action", "replace");
					// 	// $(".xans-product-image .xans-product-action").remove();
					// 	this.deleteCookie("webnGiftProduct");
					//
					// }


				}else if(this.Mall_ID == 'aromang1004'){
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_aromang1004", ".xans-product-action ", "append");
					} else {
						this.loadHtml("product_aromang1004", ".xans-product-action .ec-base-button ", "append");
					}
					// }else{
					// 	// this.loadHtml("product", ".xans-product-action", "replace");
					// 	// $(".xans-product-image .xans-product-action").remove();
					// 	this.deleteCookie("webnGiftProduct");
					//
					// }


				}else if(this.Mall_ID == 'jh8726'){
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_jh8726", ".xans-product-action ", "append");
						//this.loadHtml("product_jh8726", "#fixedActionButton .ec-base-button.gColumn ", "append");
						// this.loadHtml("product_jh8726", "#orderFixArea", "append");

					} else {
						this.loadHtml("product_jh8726", ".xans-product-action .df-action-button", "append");
					}
					// }else{
					// 	this.loadHtml("product", ".xans-product-action", "replace");
					// 	$(".xans-product-image .xans-product-action").remove();
					//
					// }


				}else if(this.Mall_ID == 'mfood1981'){
					// if(location.search.indexOf("mintweb=test")){
						/* 16번 스킨 전용 */
						this.loadHtml("product_mfood1981_tmp", ".buy-box .xans-product-action .ec-base-button", "replace");

					// }else{
					// 	this.deleteCookie("webnGiftProduct");
						/* 기존 4번 스킨 */

//						if (con == 'm.') {
//							this.loadHtml("product_mfood1981", ".xans-product-action ", "append");
//						} else {
//							this.loadHtml("product_mfood1981", ".xans-product-action .ec-base-button", "prepend");
//						}
// 					}

					// }else{
					// 	// this.loadHtml("product", ".xans-product-action", "replace");
					// 	// $(".xans-product-image .xans-product-action").remove();
					// 	this.deleteCookie("webnGiftProduct");
					// }


				}else if(this.Mall_ID == 'andyou88') {
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_andyou88", ".xans-product-action", "append");
					} else {
						this.loadHtml("product_andyou88", ".xans-product-action .ec-base-button", "append");
					}
					// }else{
					// 	this.deleteCookie("webnGiftProduct");
					//
					// }


				}else if(this.Mall_ID == 'chezsojin') {
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_chezsojin", ".xans-product-action", "append");
					} else {
						this.loadHtml("product_chezsojin", ".xans-product-action .btnArea", "append");
					}
					// }else{
					// 	this.deleteCookie("webnGiftProduct");
					//
					// }

				}else if(this.Mall_ID == 'haroutine') {
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_haroutine", ".xans-product-action", "append");
					} else {
						this.loadHtml("product_haroutine", ".xans-product-action .ec-base-button ", "prepend");
					}
					// }else{
					// 	this.deleteCookie("webnGiftProduct");
					//
					// }

				}else if(this.Mall_ID == 'stretchangels') {
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_stretchangels", ".xans-product-action .ec-base-button", "prepend");
					} else {
						this.loadHtml("product_stretchangels", ".xans-product-action .ec-base-button ", "prepend");
					}
					// }else{
					// 	this.deleteCookie("webnGiftProduct");
					//
					// }

				}else if (this.Mall_ID == 'loaislove'){
//					if(location.search.indexOf("mintweb=test") != -1){
						if (con == 'm.') {
							this.loadHtml("product_loaislove", "#fixedActionButton .ec-base-button", "append");
						} else {
							this.loadHtml("product_loaislove", ".xans-product-action .ec-base-button ", "append");
						}
//					}else{
//						this.deleteCookie("webnGiftProduct");
						
//						this.loadHtml("product", ".xans-product-action", "replace");
//						$(".xans-product-image .xans-product-action").remove();
//					}


				}else if (this.Mall_ID == 'laboh'){
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_laboh", ".xans-product-action ", "replace");
					} else {
						this.loadHtml("product_laboh", ".xans-product-action  ", "replace");
					}
					// }else{
					//
					// 	this.loadHtml("product", ".xans-product-action", "replace");
					// 	$(".xans-product-image .xans-product-action").remove();
					// }

				}else if(this.Mall_ID == 'webnmobile1') {
					if (con == 'm.') {
						this.loadHtml("product_webnombile1", ".xans-product-action", "append");
						$(".xans-product-image .xans-product-action").remove();
					} else {
						this.loadHtml("product_webnmobile1", ".xans-product-action", "append");
						$(".xans-product-image .xans-product-action").remove();
					}
				}else if(this.Mall_ID == 'rice1286'){
//					if(location.search.indexOf("mintweb=test") != -1){
						if (con == 'm.') {
							this.loadHtml("product_rice1286", ".xans-product-action .ec-base-button", "append");
						} else {
							this.loadHtml("product_rice1286", ".xans-product-action .ec-base-button", "append");
						}
//					}else{
//						this.loadHtml("product", ".xans-product-action", "replace");
//						$(".xans-product-image .xans-product-action").remove();
//					}
				}else if(this.Mall_ID == 'woozooinpizza'){
//					if(location.search.indexOf("mintweb=test") != -1){
						if( con == 'm.') {
							this.loadHtml("product", "#fixedActionButton", "replace");
						}else{
							this.loadHtml("product", ".xans-product-action", "prepend");
						}
//					}else{
//						this.deleteCookie("webnGiftProduct");
//					}
				}else if(this.Mall_ID == 'samihun1'){
//					if(location.search.indexOf("mintweb=test") != -1){
						if( con == 'm.') {
							this.loadHtml("product_samihun1", "#fixedActionButton", "prepend");
						}else{
							this.loadHtml("product_samihun1", ".xans-product-action .ec-base-button", "append");
						}
//					}else{
//						this.deleteCookie("webnGiftProduct");
//					}
				}else if(this.Mall_ID == 'jsm1218'){
//					if(location.search.indexOf("mintweb=test") != -1){
					this.loadHtml("product_jsm1218", ".wm-replace-box", "replace");
//					}else{
//						this.deleteCookie("webnGiftProduct");
//					}
				}else if(this.Mall_ID == 'mindrepublic'){
						if( con == 'm.') {
							this.loadHtml("product_mindrepublic", ".xans-product-action .ec-base-button", "append");
						}else {
							this.loadHtml("product_mindrepublic", ".xans-product-action .ec-base-button", "prepend");
						}
				

				}else if(this.Mall_ID == 'jyone01'){
						if( con == 'm.') {
							this.loadHtml("product_jyone01", ".xans-product-action .ec-base-button", "append");
						}else {
							this.loadHtml("product_jyone01", ".xans-product-action .ec-base-button", "append");
						}


				}else if(this.Mall_ID == 'nanlytjs'){
						if( con == 'm.') {
							this.loadHtml("product_nanlytjs", ".xans-product-action .ec-base-button", "replace");
						}else {
							this.loadHtml("product_nanlytjs", ".xans-product-action .ec-base-button", "replace");
						}

				}else if(this.Mall_ID == 'blackupcoffee'){
						if(location.search.indexOf("mintweb=test") != -1){
							if( con == 'm.') {
								this.loadHtml("product_blackupcoffee2", ".xans-product-action .ec-base-button", "append");
								this.loadHtml("product_blackupcoffee2", ".xans-product-optionselectlayer .ec-base-button", "append");
							}else{
								this.loadHtml("product_blackupcoffee2", ".xans-product-action ", "prepend");
							}
						}else{
							if( con == 'm.') {
								this.loadHtml("product_blackupcoffee", ".xans-product-action .ec-base-button", "append");
								this.loadHtml("product_blackupcoffee", ".xans-product-optionselectlayer .ec-base-button", "append");
							}else{
								this.loadHtml("product_blackupcoffee", ".xans-product-action ", "prepend");
							}
						}


				}else if(this.Mall_ID == 'cjwellcare'){
					if (con == 'm.') {
						this.loadHtml("product_cjwellcare", ".xans-product-action", "prepend");
					} else {
						this.loadHtml("product_cjwellcare", ".xans-product-action", "prepend");
					}


				}else if(this.Mall_ID == 'zzann'){
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						if($('#product_detail_option_layer #is_subscriptionT').prop('checked')){
							this.deleteCookie("webnGiftProduct");
						}else{
							this.loadHtml("product_zzann", ".xans-product-action ", "append");
						}
					} else {
						this.loadHtml("product_zzann", ".xans-product-action .ec-base-button", "append");
					}
					// }else{
					// 	this.loadHtml("product", ".xans-product-action", "replace");
					// 	$(".xans-product-image .xans-product-action").remove();
					// }

				}else if(this.Mall_ID == 'gmpharm0'){
					if (con == 'm.') {
						this.loadHtml("product_gmpharm0", ".xans-product-action .ec-base-button", "append");
					} else {
						this.loadHtml("product_gmpharm0", ".xans-product-action .ec-base-button", "append");
					}

				}else if(this.Mall_ID == 'elago'){
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_elago", ".xans-product-action .ec-base-button", "append");
					} else {
						this.loadHtml("product_elago", ".xans-product-action .ec-base-button", "append");
					}
					// }else{
					// 	this.loadHtml("product", ".xans-product-action", "replace");
					// }

				}else if(this.Mall_ID == 'ondasoop'){
					// if(location.search.indexOf("mintweb=test") != -1){
					if (con == 'm.') {
						this.loadHtml("product_ondasoop", "#orderFixArea", "append");
						this.loadHtml("product_ondasoop", "#product_detail_option_layer .ec-base-button  ", "append");
					} else {
						this.loadHtml("product_ondasoop", ".xans-product-action.wm", "prepend");
					}
					// }else{
					// 	this.loadHtml("product", ".xans-product-action", "replace");
					// }



				}else if(this.Mall_ID == 'req084848'){
						if(con == 'm.'){
							this.loadHtml("product_req084848_mo", ".wm_button_area ", "append");
						} else {
							this.loadHtml("product_req084848_pc", ".xans-product-action", "replace");
						}

				}else if(this.Mall_ID == 'drbronner01'){
					this.loadHtml("product_drbronner01", ".xans-product-action", "replace");


				}else if(this.Mall_ID == 'uuimui'){
					this.loadHtml("product_uuimui", ".wm_gift_area", "append");
				}else if(this.Mall_ID == 'sennshop'){
					if(con == 'm.'){
						this.loadHtml("product", ".xans-product-action", "replace");
					}else{
						this.loadHtml("product", ".xans-product-action .btnArea", "replace");
					}
				}else if(this.Mall_ID == 'forment'){
					this.loadHtml("product_forment", "body", "append");
				}else if(this.Mall_ID == 'dargeco'){
					$('.xans-product-action > .ec-base-button').remove();
					this.loadHtml("product", ".xans-product-action", "prepend");
				}else if(this.Mall_ID == 'marketb'){
					this.loadHtml("product", ".mintweb_action", "replace");
				}else if(this.Mall_ID == 'evermastic'){
						if(con == 'm.'){
							this.loadHtml("product_evermastic_mo", "#wm_gift_mo_box", "append");
						}else{
							this.loadHtml("product_evermastic_pc", "#wm_gift_pc_box", "append");
						}
				}else if(this.Mall_ID == 'gifting'){
					$('.payment_buttons').hide();
					this.loadHtml("product", ".xans-product-action", "prepend");
					$(".xans-product-image .xans-product-action").remove();
				}else if(this.Mall_ID == 'cosmechef'){
					$('.wmDn').addClass("displaynone");
					if($('.wm_gift_area').length){
						this.loadHtml("product_cosmechef", ".wm_gift_area", "prepend");
					}else if($('.wm_gift_area_mo').length){
						this.loadHtml("product_cosmechef", ".wm_gift_area_mo", "replace");
					}else{
						this.deleteCookie("webnGiftProduct");
					}
				}else{
					this.loadHtml("product", ".xans-product-action", "replace");
					$(".xans-product-image .xans-product-action").remove();
				}

				break;
			/* 장바구니 테스트 */
			case 'basket':
				this.deleteCookie("webnGiftProduct");
				this.deleteCookie("webnGiftOrder");
				
				var con = window.location.hostname.substring(0,2);
				var delvtype = this.getParam("delvtype");
				if(delvtype == 'B'){ //해외배송인 경우 처리
					break;
				}
				if(this.Mall_ID == 'webnmobile1'){
					//개별상품인 경우만 상품 추가
					
					if (config.useRange == 'goods' && config.isBasket){
//						this.loadHtml("basket",".xans-order-list .buttonGroup", "append");
//						this.loadHtml("basket_bottom",".xans-order-totalorder .buttonGroup", "append");
					}
				}
				
				if(this.Mall_ID == 'damso8071'){
					if (config.useRange == 'goods' && config.isBasket){
						if(con == 'm.'){
							this.loadHtml("basket_damso8071",".xans-order-list .btnArea .gRight", "prepend");
							this.loadHtml("basket_bottom_damso8071",".xans-order-totalorder", "prepend");
						}else{
							this.loadHtml("basket_damso8071",".xans-order-list .button", "prepend");
							this.loadHtml("basket_bottom_damso8071",".xans-order-totalorder", "prepend");
						}
					}
				}
				
				if(this.Mall_ID == 'haksanshopping'){
					//개별상품인 경우만 상품 추가
					if (config.useRange == 'goods' && config.isBasket){
						if(con == 'm.'){
							this.loadHtml("basket_bottom",".xans-order-totalorder .ec-base-button", "append");
							this.loadHtml("basket",".xans-order-list .ec-base-button", "append");
						}else{
							this.loadHtml("basket_bottom",".xans-order-totalorder", "append");
						}
					}
				}
				if(this.Mall_ID == 'orcite2017'){
//					console.log('test');
					//개별상품인 경우만 상품 추가
					if (config.useRange == 'goods' && config.isBasket){
						if(con == 'm.'){
							this.loadHtml("basket_bottom_orcite2017",".xans-order-totalorder", "append");
						}else{
							this.loadHtml("basket_bottom_orcite2017",".xans-order-totalorder", "append");
						}
					}
				}
				
				if(this.Mall_ID == 'voar'){
					if (config.useRange == 'goods' && config.isBasket){
//						if(con == 'm.'){
//							this.loadHtml("basket_voar",".xans-order-list .ec-base-button ", "prepend");
//							this.loadHtml("basket_bottom_voar",".xans-order-totalorder .ec-base-button", "prepend");
//						}else{
							this.loadHtml("basket_voar",".xans-order-list .buttonGroup", "append");
							this.loadHtml("basket_bottom_voar","#orderFixItem .ec-base-button", "append");
//						}
					}
				}
				
				if(this.Mall_ID == 'kittybunnypony'){
					if (config.useRange == 'goods' && config.isBasket){
						if(con == 'm.'){
							this.loadHtml("basket_bottom_kittybunnypony",".xans-order-totalorder", "append");
						}else{
							this.loadHtml("basket_bottom_kittybunnypony",".xans-order-totalorder", "append");
						}
					}
				}
				if(this.Mall_ID == 'dltkd9898'){
					if (config.useRange == 'goods' && config.isBasket){
						if(con == 'm.'){
							this.loadHtml("basket_dltkd9898",".xans-order-list .ec-base-button ", "append");
							this.loadHtml("basket_bottom_dltkd9898",".xans-order-totalorder .ec-base-button", "append");
						}else{
							this.loadHtml("basket_dltkd9898",".xans-order-list .button", "prepend");
							this.loadHtml("basket_bottom_dltkd9898",".xans-order-totalorder", "prepend");
						}
					}
				}
				
				if(this.Mall_ID == 'ygnext'){
					if (config.useRange == 'goods' && config.isBasket){
						if(con == 'm.'){
							this.loadHtml("basket_ygnext",".xans-order-list .btn-area ", "append");
							this.loadHtml("basket_bottom_ygnext","#btmFixMenu .xans-order-totalorder", "prepend");
						}else{
							this.loadHtml("basket_ygnext",".xans-order-list .button", "prepend");
							this.loadHtml("basket_bottom_ygnext",".xans-order-totalorder", "append");
						}
					}
				}
				
				if(this.Mall_ID == 'asyou1'){
					if (config.useRange == 'goods' && config.isBasket){
						if(con == 'm.'){
							this.loadHtml("basket_asyou1",".xans-order-list .ec-base-button ", "append");
							this.loadHtml("basket_bottom_asyou1",".xans-order-totalorder .ec-base-button", "append");
						}else{
							this.loadHtml("basket_asyou1",".xans-order-list .button", "prepend");
							this.loadHtml("basket_bottom_asyou1",".xans-order-selectorder .gRight", "prepend");
						}
					}
				}
				if(this.Mall_ID == 'lotteconf'){
//					if(location.search == '?dev=1'){
					if (config.useRange == 'goods' && config.isBasket){
						if(con == 'm.'){
							this.loadHtml("basket_lotteconf","#contents", "append");
							this.loadHtml("basket_bottom_lotteconf",".xans-order-totalorder .ec-base-button", "append");
						}else{
							this.loadHtml("basket_lotteconf","#contents", "prepend");
							this.loadHtml("basket_bottom_lotteconf",".xans-order-totalorder .btn_center", "append");
						}
					}
//					}
				}
				if(this.Mall_ID == 'imalivekombucha'){
//					if(location.search == '?dev=1'){
						if (config.useRange == 'goods' && config.isBasket){
							if(con == 'm.'){
								this.loadHtml("basket_imalivekombucha",".xans-order-list .ec-base-button ", "append");
								this.loadHtml("basket_bottom_imalivekombucha",".xans-order-totalorder .ec-base-button", "append");
							}else{
								this.loadHtml("basket_imalivekombucha",".xans-order-list .button", "prepend");
								this.loadHtml("basket_bottom_imalivekombucha",".xans-order-totalorder", "append");
							}
						}
//					}
				}
				


				if(this.Mall_ID == 'soback2'){
					// if(location.search == '?dev=1'){
					if (config.useRange == 'goods' && config.isBasket){
							this.loadHtml("basket_bottom_soback2",".xans-order-totalorder", "append");
					}
//					}
				}

				if(this.Mall_ID == 'jncadmin'){
					// if(location.search == '?dev=1'){
						if (config.useRange == 'goods' && config.isBasket){
							if(con == 'm.'){
								this.loadHtml("basket_bottom_jncadmin",".xans-order-totalorder", "prepend");
								this.loadHtml("basket_jncadmin",".xans-order-list .ec-base-button ", "append");
						}else {
								this.loadHtml("basket_bottom_jncadmin",".xans-order-totalorder", "prepend");
								this.loadHtml("basket_jncadmin",".xans-order-list .button ", "append");
							}
						}
					// }
				}

				if(this.Mall_ID == 'loaislove'){
//					if(location.search == '?dev=1'){
						if (config.useRange == 'goods' && config.isBasket){
							if(con == 'm.'){
								this.loadHtml("basket_bottom_loaislove",".xans-order-totalorder .ec-base-button", "append");
//								this.loadHtml("basket_jncadmin",".xans-order-list .ec-base-button ", "append");
							}else {
								this.loadHtml("basket_bottom_loaislove",".xans-order-totalorder", "prepend");
//								this.loadHtml("basket_jncadmin",".xans-order-list .button ", "append");
							}
						}
//					}
				}
				if(this.Mall_ID == 'blackupcoffee'){
					// if(location.search == '?dev=1'){
					if (config.useRange == 'goods' && config.isBasket){
						if(con == 'm.'){
							this.loadHtml("basket_bottom_blackupcoffee",".xans-order-totalorder .ec-base-button", "append");

						}else {
							this.loadHtml("basket_bottom_blackupcoffee",".xans-order-totalorder", "prepend");

						}
					}
//					}
				}

				if(this.Mall_ID == 'gmpharm0'){
					// if(location.search == '?dev=1'){
						if (config.useRange == 'goods' && config.isBasket){
							if(con == 'm.'){
								this.loadHtml("basket_bottom_gmpharm0",".xans-order-totalorder .ec-base-button", "append");
								this.loadHtml("basket_gmpharm0",".xans-order-list .ec-base-button .gLeft", "append");
							}else {
								this.loadHtml("basket_bottom_gmpharm0",".xans-order-totalorder", "prepend");
								this.loadHtml("basket_gmpharm0",".xans-order-list .button", "append");
							}
						// }
					}

				}

				if(this.Mall_ID == 'nanlytjs'){
					// if(location.search == '?dev=1'){
						if (config.useRange == 'goods' && config.isBasket){
							if(con == 'm.'){
								this.loadHtml("basket_bottom_nanlytjs",".xans-order-totalorder .ec-base-button", "append");
							}else {
								this.loadHtml("basket_bottom_nanlytjs",".xans-order-totalorder", "prepend");
							}
						}
					// }
				}

				if(this.Mall_ID == 'myallee434'){

					if (config.useRange == 'goods' && config.isBasket){

						this.loadHtml("basket_bottom_myallee434",".xans-order-totalorder", "append");

					}
				}

				
				if(this.Mall_ID == 'jsm1218'){
//					if(location.search == '?dev=1'){
						if (config.useRange == 'goods' && config.isBasket){
							this.loadHtml("basket_bottom_jsm1218",".xans-order-totalorder", "append");
						}
//					}
				}
				if(this.Mall_ID == 'jyone01'){
//					if(location.search == '?dev=1'){
					if (config.useRange == 'goods' && config.isBasket){
						if (con == 'm.'){
							this.loadHtml("basket_jyone01",".xans-order-list .ec-base-button", "append");
							this.loadHtml("basket_bottom_jyone01",".xans-order-totalorder", "append");
						}else{
							this.loadHtml("basket_jyone01",".xans-order-list .button", "prepend");
							this.loadHtml("basket_bottom_jyone01",".xans-order-totalorder", "append");
						}
							
//					}
					}
				}
				if(this.Mall_ID == 'sktea'){
					// if(location.search == '?dev=1'){
					if (config.useRange == 'goods' && config.isBasket){
						if (con == 'm.'){
							this.loadHtml("basket_sktea",".xans-order-list .ec-base-button", "append");
							this.loadHtml("basket_bottom_sktea",".xans-order-totalorder", "append");
						}else{
							this.loadHtml("basket_sktea",".xans-order-list .hb_cart_button", "prepend");
							this.loadHtml("basket_bottom_sktea",".xans-order-totalorder", "prepend");
						}

//					}
					}
				}
				if(this.Mall_ID == 'shopbetters'){
					if(config.isBasket){
						if (con == 'm.'){
							this.loadHtml("basket_shopbetters",".xans-order-list .btnArea .gRight", "prepend");
							this.loadHtml("basket_bottom_shopbetters",".xans-order-totalorder", "append");
						}else{
							this.loadHtml("basket_shopbetters",".xans-order-list .button", "prepend");
							this.loadHtml("basket_bottom_shopbetters",".xans-order-totalorder > p:nth-child(2)", "prepend");
						}
					}
				}
				break;
			/* 기타페이지에서는 쿠키 비우기 */
			default : 
				this.deleteCookie("webnGiftProduct");
				this.deleteCookie("webnGiftOrder");
				break;
		} 
		
	},
	/**
	* 페이지 구분
	* 
	* return String 페이지 종류 
	*/
	getLocation : function() {
		var loc = "";
		switch (location.pathname) {
			/* 주문서 */
			case "/order/orderform.html" : 
				loc  = "orderform";
				break;
			/* 주문완료 */
			case "/order/order_result.html" : 
				loc = "orderDone"; 
				break;
			/* 주문상세조회 */
			case "/myshop/order/detail.html" : 
				loc = "orderDetail";
				break;
			/* 장바구니 */
			case "/order/basket.html" :
			case "/order/basket_0809.html" :
				loc = "basket";
				break;
			default : 
				/* 상품 상세여부 체크 */
				if (location.pathname.indexOf('/product/') != -1) {
					loc = "product";
				}
			    if (this.Mall_ID == 'ghkizco' || this.Mall_ID == 'vcservice' || this.Mall_ID == 'jachoco01' || this.Mall_ID == 'bymstore' || this.Mall_ID == 'mindrepublic' || this.Mall_ID == 'evermastic') {
			    	if (location.pathname.indexOf('/P/') != -1) {
						loc = "product";
					}
			    }
//			    if (this.Mall_ID == 'foodasb2021' && location.pathname == '/userpage/test1.html'){
//			    	console.log('test');
//			    	loc = "product";
//			    }
				break;
		}
		
		return loc;
	},
	/**
	* 현재 URL에서 파라미터 값 추출 
	*
	* @param String 파라미터 key 
	* @return String 파라미터 value 
	*/
	getParam : function(sname) {
		var params = location.search.substr(location.search.indexOf("?") + 1);
		var sval = "";
		params = params.split("&");
		for (var i = 0; i < params.length; i++) {
			temp = params[i].split("=");
			if ([temp[0]] == sname) {
				sval = temp[1]; 
			}
		}
		return sval;
	},
	/**
	* 추가 필요 form html 로드 
	*
	* @param String mode html 모드 
	* @param String target html 적용할 클래스 또는 아이디
	* @param String type - replace, append, prepend - html 적용 타입 
	* @param Array  params 추가 파라미터 
	*
	* @return Boolean
	*/
	loadHtml : function(mode, target, type, params) {
		if (typeof mode == "undefined" || mode == "" || type == "undefined" || type == "")
			return false;
		
		if (typeof type == "undefined" || type == "") type = "replace";
		
		if (typeof params == "undefined" || params == "") params = {};
		
		$.ajax({
			url : webnmobile.gift.apiUrl + "html",
			type : "post",
			dataType : "html",
			data : { mode : mode, mall_id : webnmobile.gift.Mall_ID, params : params },
			success : function (data) {
				data = webnmobile.gift.decodeHtml(data);
//				console.log(data);
				$obj = $(target);
				switch (type) {
					case "replace" : 
						$obj.html(data);
						break;
					case "append" : 
						$obj.append(data);
						break;
					case "prepend" : 
						$obj.prepend(data);
						break;
				}
			},
			error : function (res) {
				console.log(res);
			}
		});
		
		return true;
	},
	/**
	* 주문정보 전송
	*
	* @param String order_id 주문번호 
	* @return JSON
	*/
	sendOrderInfo : function(order_id) {
		
		if (typeof order_id == "undefined" || order_id == "")
			return; 
		
		if (typeof this.Mall_ID == "undefined" || this.Mall_ID == "")
			return; 
		
		/* 선물하기 주문인 경우만 전송 반영 */
		var webnGiftOrder = this.getCookie("webnGiftOrder");
		console.log(webnGiftOrder);
		if (webnGiftOrder == '1') {
			var params = {
				SHOP_NO : this.SHOP_NO,
				Mall_ID : this.Mall_ID,
				order_id : order_id,
			};

			$.ajax({
				url : this.apiUrl + "update_order_info",
				type : "post", 
				dataType : "text",
				data : params,
				async: false,
				success : function (data) {
					webnmobile.gift.checkOr=true;
				},
				error : function (res) {
					console.log(res);
				}
			});
		} // endif 
		else{
			webnmobile.gift.checkOr=false;
		}
	},
	/**
	* 선물하기 주문인지여부 체크 하고 선물하기 주문인 경우 
	* 주문상세조회에서 배송지 변경 버튼 감추기 
	*
	* @param String order_id 주문번호 
	* @return boolean
	*/
	chkGiftOrder : function (order_id) {
		if (typeof order_id == "undefined" || order_id == "")
			return false;
		
		var params = {
			SHOP_NO : this.SHOP_NO,
			Mall_ID : this.Mall_ID,
			order_id : order_id,
		};
		
		$.ajax({
			url : this.apiUrl + "chk_gift_order",
			type : "post", 
			dataType : "text",
			data : params,
			async:false,
			success : function (data) {
				if (data == "1") {
					webnmobile.gift.checkOr=true;
					$list = $(".orderArea *");
					$.each($list, function() {
						var v = $(this).text();
						if (v == '배송지 변경') {
							$(this).remove();
						}
					});
				} // endif 
				else {
					this.checkOr=false;
				}
			},
			error : function (res) {
				console.log(res);
			}
		});
	},
	/**
	* 상품전용 선물하기에서 
	* 여러상품이 주문되는경우 선물하기 이외의 상품이 적용되어 있다면 
	* 함께 주문되지 않도록 차단 
	* 
	* throw Exception 
	*/
	chkGiftProductOrder : function() {
		var config = this.getConfig();
		if (!config)
			throw "선물하기 설정을 확인하세요.";
		
		CAFE24API.getCartItemList(function(err, res) {
			if (err) {
				throw "주문 품목조회에 실패하였습니다.";
			} else {
				console.log(res);
				if (res && res.items.length > 0) {
					var items = res.items;
					items.forEach(function(el) {
						var isPossible = false;
						var product_no = el.product_no;
						if (config.pList && config.pList.length > 0) {
							for (key in config.pList) {
								var c = config.pList[key];

								if (c.product_no == product_no && c.isGift == '1') {
									isPossible = true;
								}
							}
						} // endif 
						if (!isPossible) {
							throw "선물하기가 가능하지 않은 상품과 함께 주문하실 수 없습니다.";
						}
					});
				} else {
					throw "주문 상품이 존재하지 않습니다.";
				}
			}
		});
	},
	/**
	* 개별 상품인 경우 상품 개수 확인
	* 
	* throw Exception 
	*/
	chkGiftProductOrder2 : function() {
		var config = this.getConfig();
		var giftFl = true;
		if (!config)
			throw "선물하기 설정을 확인하세요.";
		
		CAFE24API.getCartItemList(function(err, res) {
			if (err) {
				throw "주문 품목조회에 실패하였습니다.";
			} else {
	
				if (res && res.items.length > 0) {
					var items = res.items;
					var itemCount = 0;
					var itemArray = [];
					items.forEach(function(el) {
						itemArray.push(el.product_no);
						itemCount++;
					});
					
					$.ajax({
						url : webnmobile.gift.apiUrl + 'gift_check_basket_order',
						type : "post",
						dataType : "json",
						data : {mall_id : webnmobile.gift.Mall_ID, product_no : itemArray},
						async : false,
						success : function(data){
							if(data != 'pass'){
								giftFl = false;
							}
						}
					});
					
//					if(itemCount != 1 && config.useRange == 'goods'){
//						giftFl = false;
//					}
				}
			}
		});
		if(giftFl)
			return 1;
		else
			return 0;
	},
	
	/**
	 * 선물하기 상품인지 확인
	 */
	checkGift : function(product_no)
	{
		var returnData = [];
		$.ajax({
			url : this.apiUrl + 'gift_check_basket',
			type : "post",
			dataType : "json",
			data : {mall_id : this.Mall_ID, product_no : product_no},
			async : false,
			success : function(data){
				returnData = data;
			},fail : function(data){
				console.log(data);
			}
		});
		return returnData;
	},
	
	/**
	 * 선물하기 상품 품절 여부 확인
	 */
	checkSoldOut : function(product_no)
	{
		var returnData = [];

		$.ajax({
			url : this.apiUrl + 'checkSoldOut',
			type : "post",
			dataType : "json",
			data : {mall_id : this.Mall_ID, shop_no : this.SHOP_NO, product_no : product_no},
			async : false,
			success : function(data){
				returnData = data;
			},fail : function(data){
				console.log(data);
			}
		});
		return returnData;
	},
	
	/**
	* 쿠키 설정 
	*
	*/
	setCookie  : function(name, value, day) {
        var date = new Date();
        date.setTime(date.getTime() + day * 60 * 60 * 24 * 1000);
        document.cookie = name + '=' + value + ';expires=' + date.toUTCString() + ';path=/';
    },
	/**
	* 쿠키 조회 
	*
	*/
	getCookie : function(name) {
        var value = document.cookie.match('(^|;) ?' + name + '=([^;]*)(;|$)');
        return value? value[2] : null;
    },
	/**
	* 쿠키 삭제 
	*
	*/
	deleteCookie : function(name) {
        var date = new Date();
        document.cookie = name + "= " + "; expires=" + date.toUTCString() + "; path=/";
    },
	decodeHtml : function (str) {
		var map = {
			'&amp;': '&',
			'&lt;': '<',
			'&gt;': '>',
			'&quot;': '"',
			'&#039;': "'"
		};
		return str.replace(/&amp;|&lt;|&gt;|&quot;|&#039;/g, function(m) {return map[m];});
	}
    
};

(function(CAFE24API) {
	/* 선물하기 초기화 */
	webnmobile.gift.init(CAFE24API.MALL_ID, CAFE24API.SHOP_NO);
	
	
})(CAFE24API.init({
	client_id : 'oPQvJewJSKfD2biHOR25TH',
	version : '2020-06-01',
}));
